using System;
using System.IO;
using System.Text;

class Program
{
    static string filePath = "secret.txt";
    static byte xorKey;

    static void Main(string[] args)
    {
        Console.WriteLine("Enter your password: ");
        string password = Console.ReadLine();  
        xorKey = GetKeyFromPassword(password);

        if(!File.Exists(filePath))
        {
            Console.WriteLine("Save not found. Creating encrypted save file...");
            string defaultData = "Welcome to your encrypted adventure!";
            string encrypted = EncryptDecrypt(defaultData);
            File.WriteAllText(filePath, encrypted);
        }

        try 
        { 
            string rawContent = File.ReadAllText(filePath);
            string decrypted = EncryptDecrypt(rawContent);
            Console.WriteLine("Secret File Loaded: ");
            Console.WriteLine(decrypted);
        }

        catch (Exception ex) 
        {
            Console.WriteLine($"Error reading ot decrypting file: {ex.Message}");
        }
    }

    static byte GetKeyFromPassword(string password)
    {
        int hash = 0;
        foreach (char c in password)
        {
            hash += c;
        }
        return (byte) (hash % 256);
    }

    static string EncryptDecrypt(string input)
    {
        StringBuilder output = new StringBuilder();
        foreach (char c in input)
        {
            char encryptedChar = (char) (c ^ xorKey);
            output.Append(encryptedChar);
        }
        return output.ToString();
    }
}
